valid = [
    "Rainbow",
    "RainbowHM",
    "Iron",
    "Greyscale",
    "FLIR_Arctic",
    "FLIR_Gray",
    "FLIR_Iron",
    "FLIR_Lava",
    "FLIR_Rainbow",
    "FLIR_RainbowHC",
]


def colormaps():
    return valid


# A helper function related the colormap handling in matplotlib:


def get_cmap(name, lut=None):
    """
    Return the colormap with that name.
    Modeled after matplotlib.cm.get_cmap() but for the colormaps defined here.

    Raises ValueError if not found.
    """
    if name not in colormaps():
        raise ValueError(
            f"'{name}' is not a valid value for name; supported values are {', '.join(colormaps())}"
        )
    cls = globals().get(name)
    return cls.create_mpl_cmap(N=lut or 1024)


# The abstract Colormap class:


class Colormap:

    int_cdict = None
    float_cdict = None
    name = None

    @classmethod
    def get_float_cdict(cls):
        if cls.float_cdict is not None:
            return cls.float_cdict
        else:
            cdict = {"red": [], "green": [], "blue": []}
            for color, stops in cls.int_cdict.items():
                for x, y0, y1 in stops:
                    cdict[color].append((x / 1023.0, y0 / 255.0, y1 / 255.0))
            return cdict

    @classmethod
    def create_mpl_cmap(cls, N=1024, gamma=1.0):
        import matplotlib.colors

        cdict = cls.get_float_cdict()
        return matplotlib.colors.LinearSegmentedColormap(
            cls.name, cdict, N=N, gamma=gamma
        )


# The individual colormaps:


class Greyscale(Colormap):
    name = "Greyscale"
    int_cdict = {
        "blue": [(0, 0, 0), (1023, 255, 255)],
        "green": [(0, 0, 0), (1023, 255, 255)],
        "red": [(0, 0, 0), (1023, 255, 255)],
    }


class Rainbow(Colormap):
    name = "Rainbow"
    int_cdict = {
        "blue": [
            (0, 196, 196),
            (256, 255, 255),
            (511, 0, 0),
            (767, 0, 0),
            (1023, 0, 0),
        ],
        "green": [
            (0, 0, 0),
            (256, 255, 255),
            (511, 157, 157),
            (767, 255, 255),
            (1023, 0, 0),
        ],
        "red": [(0, 0, 0), (256, 0, 0), (511, 0, 0), (767, 255, 255), (1023, 255, 255)],
    }


class RainbowHM(Colormap):
    name = "RainbowHM"
    int_cdict = {
        "blue": [
            (0, 0, 0),
            (143, 210, 210),
            (296, 240, 240),
            (440, 1, 1),
            (583, 14, 14),
            (732, 0, 0),
            (880, 0, 0),
            (1023, 254, 254),
        ],
        "green": [
            (0, 0, 0),
            (143, 1, 1),
            (296, 239, 239),
            (440, 134, 134),
            (583, 231, 231),
            (732, 131, 131),
            (880, 1, 1),
            (1023, 254, 254),
        ],
        "red": [
            (0, 0, 0),
            (143, 0, 0),
            (296, 8, 8),
            (440, 0, 0),
            (583, 241, 241),
            (732, 255, 255),
            (880, 255, 255),
            (1023, 255, 255),
        ],
    }


class Iron(Colormap):
    name = "Iron"
    int_cdict = {
        "blue": [
            (0, 0, 0),
            (71, 103, 103),
            (315, 175, 175),
            (335, 163, 163),
            (511, 44, 44),
            (695, 0, 0),
            (868, 55, 55),
            (874, 61, 61),
            (1023, 255, 255),
        ],
        "green": [
            (0, 0, 0),
            (71, 0, 0),
            (315, 0, 0),
            (335, 4, 4),
            (511, 44, 44),
            (695, 126, 126),
            (868, 229, 229),
            (874, 231, 231),
            (1023, 255, 255),
        ],
        "red": [
            (0, 0, 0),
            (71, 5, 5),
            (315, 183, 183),
            (335, 188, 188),
            (511, 224, 224),
            (695, 255, 255),
            (868, 255, 255),
            (874, 255, 255),
            (1023, 255, 255),
        ],
    }


class FLIR_Iron(Colormap):
    name = "FLIR_Iron"
    float_cdict = {
        "blue": [
            (0.0, 0.094, 0.094),
            (0.0282, 0.161, 0.161),
            (0.0732, 0.314, 0.314),
            (0.1137, 0.42, 0.42),
            (0.1842, 0.533, 0.533),
            (0.2451, 0.604, 0.604),
            (0.3147, 0.643, 0.643),
            (0.3556, 0.659, 0.659),
            (0.4093, 0.655, 0.655),
            (0.482, 0.627, 0.627),
            (0.5434, 0.58, 0.58),
            (0.6189, 0.463, 0.463),
            (0.6685, 0.361, 0.361),
            (0.7094, 0.235, 0.235),
            (0.744, 0.075, 0.075),
            (0.7658, 0.0, 0.0),
            (0.7949, 0.0, 0.0),
            (0.8217, 0.145, 0.145),
            (0.8395, 0.259, 0.259),
            (0.8568, 0.369, 0.369),
            (0.9363, 0.749, 0.749),
            (1.0, 1.0, 1.0),
        ],
        "green": [
            (0.0, 0.067, 0.067),
            (0.0282, 0.051, 0.051),
            (0.0732, 0.016, 0.016),
            (0.1137, 0.0, 0.0),
            (0.1842, 0.0, 0.0),
            (0.2451, 0.0, 0.0),
            (0.3147, 0.0, 0.0),
            (0.3556, 0.0, 0.0),
            (0.4093, 0.0, 0.0),
            (0.482, 0.039, 0.039),
            (0.5434, 0.078, 0.078),
            (0.6189, 0.161, 0.161),
            (0.6685, 0.231, 0.231),
            (0.7094, 0.333, 0.333),
            (0.744, 0.49, 0.49),
            (0.7658, 0.604, 0.604),
            (0.7949, 0.753, 0.753),
            (0.8217, 0.871, 0.871),
            (0.8395, 0.914, 0.914),
            (0.8568, 0.941, 0.941),
            (0.9363, 1.0, 1.0),
            (1.0, 1.0, 1.0),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.0282, 0.0, 0.0),
            (0.0732, 0.0, 0.0),
            (0.1137, 0.082, 0.082),
            (0.1842, 0.212, 0.212),
            (0.2451, 0.314, 0.314),
            (0.3147, 0.424, 0.424),
            (0.3556, 0.478, 0.478),
            (0.4093, 0.541, 0.541),
            (0.482, 0.639, 0.639),
            (0.5434, 0.714, 0.714),
            (0.6189, 0.816, 0.816),
            (0.6685, 0.878, 0.878),
            (0.7094, 0.941, 0.941),
            (0.744, 1.0, 1.0),
            (0.7658, 1.0, 1.0),
            (0.7949, 1.0, 1.0),
            (0.8217, 1.0, 1.0),
            (0.8395, 1.0, 1.0),
            (0.8568, 1.0, 1.0),
            (0.9363, 0.969, 0.969),
            (1.0, 0.953, 0.953),
        ],
    }


class FLIR_Arctic(Colormap):
    name = "FLIR_Arctic"
    float_cdict = {
        "blue": [
            (0.0, 0.58, 0.58),
            (0.04, 0.639, 0.639),
            (0.1028, 0.847, 0.847),
            (0.151, 0.945, 0.945),
            (0.1678, 1.0, 1.0),
            (0.261, 0.996, 0.996),
            (0.3297, 0.996, 0.996),
            (0.4052, 1.0, 1.0),
            (0.4229, 0.98, 0.98),
            (0.4452, 0.937, 0.937),
            (0.4789, 0.855, 0.855),
            (0.5007, 0.78, 0.78),
            (0.6048, 0.392, 0.392),
            (0.6889, 0.235, 0.235),
            (0.7722, 0.0, 0.0),
            (0.779, 0.0, 0.0),
            (0.8454, 0.0, 0.0),
            (0.8568, 0.0, 0.0),
            (0.9736, 0.761, 0.761),
            (1.0, 0.816, 0.816),
        ],
        "green": [
            (0.0, 0.0, 0.0),
            (0.04, 0.0, 0.0),
            (0.1028, 0.0, 0.0),
            (0.151, 0.0, 0.0),
            (0.1678, 0.012, 0.012),
            (0.261, 0.263, 0.263),
            (0.3297, 0.475, 0.475),
            (0.4052, 0.871, 0.871),
            (0.4229, 0.957, 0.957),
            (0.4452, 0.933, 0.933),
            (0.4789, 0.859, 0.859),
            (0.5007, 0.78, 0.78),
            (0.6048, 0.392, 0.392),
            (0.6889, 0.388, 0.388),
            (0.7722, 0.392, 0.392),
            (0.779, 0.408, 0.408),
            (0.8454, 0.82, 0.82),
            (0.8568, 0.851, 0.851),
            (0.9736, 0.965, 0.965),
            (1.0, 0.98, 0.98),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.04, 0.0, 0.0),
            (0.1028, 0.0, 0.0),
            (0.151, 0.0, 0.0),
            (0.1678, 0.004, 0.004),
            (0.261, 0.0, 0.0),
            (0.3297, 0.059, 0.059),
            (0.4052, 0.161, 0.161),
            (0.4229, 0.184, 0.184),
            (0.4452, 0.227, 0.227),
            (0.4789, 0.271, 0.271),
            (0.5007, 0.306, 0.306),
            (0.6048, 0.392, 0.392),
            (0.6889, 0.624, 0.624),
            (0.7722, 0.98, 0.98),
            (0.779, 0.992, 0.992),
            (0.8454, 0.996, 0.996),
            (0.8568, 0.996, 0.996),
            (0.9736, 1.0, 1.0),
            (1.0, 0.996, 0.996),
        ],
    }


class FLIR_Gray(Colormap):
    name = "FLIR_Gray"
    float_cdict = {
        "blue": [
            (0.0, 0.0, 0.0),
            (0.5057, 0.298, 0.298),
            (0.6389, 0.408, 0.408),
            (0.6926, 0.471, 0.471),
            (0.7322, 0.561, 0.561),
            (0.7772, 0.69, 0.69),
            (0.8085, 0.796, 0.796),
            (0.8313, 0.855, 0.855),
            (0.8454, 0.882, 0.882),
            (0.8918, 0.929, 0.929),
            (1.0, 0.996, 0.996),
        ],
        "green": [
            (0.0, 0.0, 0.0),
            (0.5057, 0.298, 0.298),
            (0.6389, 0.408, 0.408),
            (0.6926, 0.471, 0.471),
            (0.7322, 0.561, 0.561),
            (0.7772, 0.69, 0.69),
            (0.8085, 0.796, 0.796),
            (0.8313, 0.855, 0.855),
            (0.8454, 0.882, 0.882),
            (0.8918, 0.929, 0.929),
            (1.0, 0.996, 0.996),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.5057, 0.298, 0.298),
            (0.6389, 0.408, 0.408),
            (0.6926, 0.471, 0.471),
            (0.7322, 0.561, 0.561),
            (0.7772, 0.69, 0.69),
            (0.8085, 0.796, 0.796),
            (0.8313, 0.855, 0.855),
            (0.8454, 0.882, 0.882),
            (0.8918, 0.929, 0.929),
            (1.0, 0.996, 0.996),
        ],
    }


class FLIR_Lava(Colormap):
    name = "FLIR_Lava"
    float_cdict = {
        "blue": [
            (0.0, 0.0, 0.0),
            (0.0359, 0.125, 0.125),
            (0.0996, 0.439, 0.439),
            (0.1446, 0.631, 0.631),
            (0.3024, 0.647, 0.647),
            (0.4993, 0.573, 0.573),
            (0.5734, 0.525, 0.525),
            (0.6562, 0.475, 0.475),
            (0.6926, 0.357, 0.357),
            (0.7444, 0.149, 0.149),
            (0.7649, 0.149, 0.149),
            (0.7726, 0.122, 0.122),
            (0.7981, 0.0, 0.0),
            (0.8163, 0.0, 0.0),
            (0.8299, 0.0, 0.0),
            (0.8481, 0.004, 0.004),
            (0.8868, 0.0, 0.0),
            (0.9363, 0.498, 0.498),
            (1.0, 0.996, 0.996),
        ],
        "green": [
            (0.0, 0.0, 0.0),
            (0.0359, 0.051, 0.051),
            (0.0996, 0.188, 0.188),
            (0.1446, 0.267, 0.267),
            (0.3024, 0.4, 0.4),
            (0.4993, 0.502, 0.502),
            (0.5734, 0.549, 0.549),
            (0.6562, 0.192, 0.192),
            (0.6926, 0.153, 0.153),
            (0.7444, 0.086, 0.086),
            (0.7649, 0.18, 0.18),
            (0.7726, 0.227, 0.227),
            (0.7981, 0.384, 0.384),
            (0.8163, 0.561, 0.561),
            (0.8299, 0.663, 0.663),
            (0.8481, 0.765, 0.765),
            (0.8868, 0.851, 0.851),
            (0.9363, 0.929, 0.929),
            (1.0, 0.996, 0.996),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.0359, 0.027, 0.027),
            (0.0996, 0.086, 0.086),
            (0.1446, 0.129, 0.129),
            (0.3024, 0.0, 0.0),
            (0.4993, 0.0, 0.0),
            (0.5734, 0.0, 0.0),
            (0.6562, 0.471, 0.471),
            (0.6926, 0.596, 0.596),
            (0.7444, 0.804, 0.804),
            (0.7649, 0.953, 0.953),
            (0.7726, 0.996, 0.996),
            (0.7981, 1.0, 1.0),
            (0.8163, 0.996, 0.996),
            (0.8299, 1.0, 1.0),
            (0.8481, 0.996, 0.996),
            (0.8868, 0.996, 0.996),
            (0.9363, 1.0, 1.0),
            (1.0, 0.996, 0.996),
        ],
    }


class FLIR_Rainbow(Colormap):
    name = "FLIR_Rainbow"
    float_cdict = {
        "blue": [
            (0.0, 0.278, 0.278),
            (0.0441, 0.302, 0.302),
            (0.0668, 0.329, 0.329),
            (0.1464, 0.486, 0.486),
            (0.1801, 0.537, 0.537),
            (0.3361, 0.792, 0.792),
            (0.4079, 0.863, 0.863),
            (0.4425, 0.871, 0.871),
            (0.4702, 0.851, 0.851),
            (0.5002, 0.792, 0.792),
            (0.5289, 0.686, 0.686),
            (0.5362, 0.655, 0.655),
            (0.5548, 0.541, 0.541),
            (0.5698, 0.478, 0.478),
            (0.5866, 0.337, 0.337),
            (0.6257, 0.149, 0.149),
            (0.6548, 0.059, 0.059),
            (0.6776, 0.012, 0.012),
            (0.7035, 0.0, 0.0),
            (0.7212, 0.02, 0.02),
            (0.7372, 0.035, 0.035),
            (0.7522, 0.059, 0.059),
            (0.7726, 0.11, 0.11),
            (0.789, 0.192, 0.192),
            (0.7981, 0.239, 0.239),
            (0.8049, 0.275, 0.275),
            (0.8154, 0.329, 0.329),
            (0.8199, 0.353, 0.353),
            (0.8358, 0.408, 0.408),
            (0.8454, 0.463, 0.463),
            (0.8554, 0.482, 0.482),
            (0.8918, 0.58, 0.58),
            (0.9404, 0.698, 0.698),
            (0.955, 0.729, 0.729),
            (1.0, 0.8, 0.8),
        ],
        "green": [
            (0.0, 0.008, 0.008),
            (0.0441, 0.012, 0.012),
            (0.0668, 0.027, 0.027),
            (0.1464, 0.165, 0.165),
            (0.1801, 0.204, 0.204),
            (0.3361, 0.349, 0.349),
            (0.4079, 0.412, 0.412),
            (0.4425, 0.451, 0.451),
            (0.4702, 0.475, 0.475),
            (0.5002, 0.514, 0.514),
            (0.5289, 0.549, 0.549),
            (0.5362, 0.557, 0.557),
            (0.5548, 0.584, 0.584),
            (0.5698, 0.596, 0.596),
            (0.5866, 0.635, 0.635),
            (0.6257, 0.706, 0.706),
            (0.6548, 0.753, 0.753),
            (0.6776, 0.8, 0.8),
            (0.7035, 0.835, 0.835),
            (0.7212, 0.831, 0.831),
            (0.7372, 0.792, 0.792),
            (0.7522, 0.722, 0.722),
            (0.7726, 0.541, 0.541),
            (0.789, 0.231, 0.231),
            (0.7981, 0.118, 0.118),
            (0.8049, 0.094, 0.094),
            (0.8154, 0.137, 0.137),
            (0.8199, 0.188, 0.188),
            (0.8358, 0.329, 0.329),
            (0.8454, 0.439, 0.439),
            (0.8554, 0.478, 0.478),
            (0.8918, 0.651, 0.651),
            (0.9404, 0.8, 0.8),
            (0.955, 0.835, 0.835),
            (1.0, 0.902, 0.902),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.0441, 0.0, 0.0),
            (0.0668, 0.0, 0.0),
            (0.1464, 0.004, 0.004),
            (0.1801, 0.0, 0.0),
            (0.3361, 0.0, 0.0),
            (0.4079, 0.004, 0.004),
            (0.4425, 0.0, 0.0),
            (0.4702, 0.0, 0.0),
            (0.5002, 0.012, 0.012),
            (0.5289, 0.027, 0.027),
            (0.5362, 0.027, 0.027),
            (0.5548, 0.059, 0.059),
            (0.5698, 0.086, 0.086),
            (0.5866, 0.176, 0.176),
            (0.6257, 0.357, 0.357),
            (0.6548, 0.49, 0.49),
            (0.6776, 0.635, 0.635),
            (0.7035, 0.796, 0.796),
            (0.7212, 0.886, 0.886),
            (0.7372, 0.949, 0.949),
            (0.7522, 0.98, 0.98),
            (0.7726, 1.0, 1.0),
            (0.789, 0.992, 0.992),
            (0.7981, 0.984, 0.984),
            (0.8049, 0.973, 0.973),
            (0.8154, 0.973, 0.973),
            (0.8199, 0.965, 0.965),
            (0.8358, 0.973, 0.973),
            (0.8454, 0.988, 0.988),
            (0.8554, 0.988, 0.988),
            (0.8918, 0.996, 0.996),
            (0.9404, 0.996, 0.996),
            (0.955, 0.996, 0.996),
            (1.0, 1.0, 1.0),
        ],
    }


class FLIR_RainbowHC(Colormap):
    name = "FLIR_RainbowHC"
    float_cdict = {
        "blue": [
            (0.0, 0.0, 0.0),
            (0.0036, 0.0, 0.0),
            (0.03, 0.094, 0.094),
            (0.1151, 0.537, 0.537),
            (0.2001, 0.902, 0.902),
            (0.4129, 0.596, 0.596),
            (0.4497, 0.655, 0.655),
            (0.4688, 0.671, 0.671),
            (0.4993, 0.729, 0.729),
            (0.5312, 0.78, 0.78),
            (0.5834, 0.898, 0.898),
            (0.6553, 0.427, 0.427),
            (0.694, 0.031, 0.031),
            (0.6994, 0.0, 0.0),
            (0.7217, 0.0, 0.0),
            (0.7258, 0.0, 0.0),
            (0.749, 0.0, 0.0),
            (0.7535, 0.0, 0.0),
            (0.789, 0.0, 0.0),
            (0.794, 0.016, 0.016),
            (0.8208, 0.129, 0.129),
            (0.8345, 0.173, 0.173),
            (0.8427, 0.239, 0.239),
            (0.8518, 0.318, 0.318),
            (0.894, 0.565, 0.565),
            (0.9518, 0.804, 0.804),
            (1.0, 0.969, 0.969),
        ],
        "green": [
            (0.0, 0.0, 0.0),
            (0.0036, 0.0, 0.0),
            (0.03, 0.0, 0.0),
            (0.1151, 0.0, 0.0),
            (0.2001, 0.0, 0.0),
            (0.4129, 0.0, 0.0),
            (0.4497, 0.169, 0.169),
            (0.4688, 0.231, 0.231),
            (0.4993, 0.4, 0.4),
            (0.5312, 0.565, 0.565),
            (0.5834, 0.898, 0.898),
            (0.6553, 0.592, 0.592),
            (0.694, 0.333, 0.333),
            (0.6994, 0.329, 0.329),
            (0.7217, 0.533, 0.533),
            (0.7258, 0.596, 0.596),
            (0.749, 0.882, 0.882),
            (0.7535, 0.875, 0.875),
            (0.789, 0.063, 0.063),
            (0.794, 0.012, 0.012),
            (0.8208, 0.133, 0.133),
            (0.8345, 0.169, 0.169),
            (0.8427, 0.239, 0.239),
            (0.8518, 0.318, 0.318),
            (0.894, 0.565, 0.565),
            (0.9518, 0.808, 0.808),
            (1.0, 0.969, 0.969),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.0036, 0.0, 0.0),
            (0.03, 0.094, 0.094),
            (0.1151, 0.533, 0.533),
            (0.2001, 0.906, 0.906),
            (0.4129, 0.0, 0.0),
            (0.4497, 0.0, 0.0),
            (0.4688, 0.0, 0.0),
            (0.4993, 0.0, 0.0),
            (0.5312, 0.0, 0.0),
            (0.5834, 0.0, 0.0),
            (0.6553, 0.0, 0.0),
            (0.694, 0.0, 0.0),
            (0.6994, 0.035, 0.035),
            (0.7217, 0.337, 0.337),
            (0.7258, 0.435, 0.435),
            (0.749, 0.863, 0.863),
            (0.7535, 0.882, 0.882),
            (0.789, 0.498, 0.498),
            (0.794, 0.502, 0.502),
            (0.8208, 0.737, 0.737),
            (0.8345, 0.82, 0.82),
            (0.8427, 0.855, 0.855),
            (0.8518, 0.871, 0.871),
            (0.894, 0.914, 0.914),
            (0.9518, 0.957, 0.957),
            (1.0, 0.988, 0.988),
        ],
    }
